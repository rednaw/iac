# OpenTelemetry Collector: host metrics + Docker container metrics -> OpenObserve
# Matches OpenObserve UI "Data sources -> Linux" (openobserve/agents install.sh).
# Endpoint = base URL only; auth = Basic with key from UI.

receivers:
  hostmetrics:
    collection_interval: 30s
    scrapers:
      cpu: {}
      disk: {}
      filesystem:
        include_mount_points:
          mount_points:
            - /var/lib/openobserve
            - /var/lib/docker-registry
        include_fs_types:
          - ext4
          - xfs
          - btrfs
      load: {}
      memory: {}
      network: {}
  
  # Docker container metrics (CPU, memory, network, health status)
  docker_stats:
    endpoint: "unix:///var/run/docker.sock"
    collection_interval: 30s
    timeout: 5s

exporters:
  otlphttp:
    endpoint: http://openobserve:5080/api/default/
    tls:
      insecure: true
    headers:
      Authorization: "Basic {{ openobserve_ingest_auth }}"

service:
  pipelines:
    metrics:
      receivers: [hostmetrics, docker_stats]
      exporters: [otlphttp]
